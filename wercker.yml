box: flenter/android
build:
  steps:
    - script:
        name: set android env variables
        code: |
          export ANDROID_HOME="/home/ubuntu/android-sdk-linux"
          export PATH="${PATH}:${ANDROID_HOME}/tools:${ANDROID_HOME}/platform-tools"
    - script:
        name: install gradle
        code: |
          cd /tmp
          wget http://services.gradle.org/distributions/gradle-1.7-bin.zip
          unzip gradle-1.7-bin.zip
          export GRADLE_HOME=/tmp/gradle-1.7
          export PATH=$PATH:$GRADLE_HOME/bin
          export
          ls -la ~/.android/avd/
          ls -la /pipeline/build/
    - script:
        name: add more build tools
        code: |
          cd /tmp/
          wget https://dl-ssl.google.com/android/repository/build-tools_r18.0.1-linux.zip
          unzip build-tools_r18.0.1-linux.zip -d $ANDROID_HOME
          mkdir -p $ANDROID_HOME/build-tools/
          mv $ANDROID_HOME/android-4.3 $ANDROID_HOME/build-tools/18.0.1
          cd $WERCKER_SOURCE_DIR
    - script:
        name: update sdk
        code: |
          cd $ANDROID_HOME
          expect /pipeline/build/android-update.exp
          cd $WERCKER_SOURCE_DIR
    - script:
        name: remove local.properties
        code: |
          ls -la
    # rm local.properties
    - script:
        name: android project
        code: |
          android update project --name Hello --path ./Hello
    - script:
        name: run gradle
        code: |
          gradle -v
          gradle --refresh-dependencies -q --rerun-tasks --full-stacktrace build
